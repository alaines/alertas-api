datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model WazeIncident {
  id             BigInt   @id @default(autoincrement())
  source         String   @default("waze")
  uuid           String   @unique
  type           String
  subtype        String?
  city           String?
  street         String?
  road_type      Int?
  magvar         Int?
  report_rating  Int?
  report_by_muni Boolean
  confidence     Int?
  reliability    Int?
  pub_millis     BigInt
  pub_time       DateTime @db.Timestamptz(6)
  category       String?
  priority       Int?
  status         String   @default("active")
  created_at     DateTime @db.Timestamptz(6) @default(now())
  updated_at     DateTime @db.Timestamptz(6) @default(now())

  @@map("waze_incidents")
}

model User {
  id         Int      @id @default(autoincrement())
  email      String   @unique
  username   String   @unique
  password   String
  fullName   String   @map("full_name")
  role       UserRole @default(VIEWER)
  isActive   Boolean  @default(true) @map("is_active")
  createdAt  DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt  DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)
  lastLogin  DateTime? @map("last_login") @db.Timestamptz(6)

  @@map("users")
}

enum UserRole {
  ADMIN      // Acceso total al sistema
  OPERATOR   // Puede ver y gestionar incidentes
  VIEWER     // Solo lectura
}

model spatial_ref_sys {
  srid      Int     @id
  auth_name String?
  auth_srid Int?
  srtext    String?
  proj4text String?

  @@ignore
}
